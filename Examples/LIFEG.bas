10 REM    THE GAME OF LIFE, WITH GRAPHICS.       SAM SANDS  OCT 14, 197720   DIM A(46,57)30   Rows=4540   Columns=5650   Null=060   Cursor=170   Star=280   Scratch=390   PLOTTER IS 13,"GRAPHICS"100  SCALE 0,MAX(Columns,Rows*560/455),MAX(Rows,Columns*455/560),0110 Begin: MAT A=(0)120  GCLEAR 130  GRAPHICS140  G=0150 Repeat:  Mode=Cursor160  C=C0=(Columns+1) DIV 2170  R=R0=(Rows+1) DIV 2
180  PEN 1190  CALL Cursor(R,C)200  GOSUB Clear_keys210  ON KEY #0 GOSUB Left220  ON KEY #1 GOSUB Upleft230  ON KEY #2 GOSUB Up240  ON KEY #3 GOSUB Upright250  ON KEY #4 GOSUB Right260  ON KEY #8 GOSUB Left270  ON KEY #9 GOSUB Downleft280  ON KEY #10 GOSUB Down290  ON KEY #11 GOSUB Downright300  ON KEY #12 GOSUB Right310  ON KEY #6 GOTO Start320  ON KEY #13 GOSUB Cursor330  ON KEY #14 GOSUB Star340  ON KEY #15 GOSUB Scratch341  ON KEY #7 GOTO Out342  GOTO 350343 Out:  GET "MENU",10,10350 Idle:  GRAPHICS360  GOTO Idle370 Left:   C=(C-2) MOD Columns+1380  GOTO Change390 Right:  C=C MOD Columns+1400  GOTO Change410 Upleft:  R=(R-2) MOD Rows+1420  C=(C-2) MOD Columns+1430  GOTO Change440 Up:  R=(R-2) MOD Rows+1450  GOTO Change460 Upright:  R=(R-2) MOD Rows+1470  C=C MOD Columns+1480  GOTO Change490 Downleft:  C=(C-2) MOD Columns+1500  R=R MOD Rows+1510  GOTO Change520 Down:  R=R MOD Rows+1530  GOTO Change540 Downright:  R=R MOD Rows+1550  C=C MOD Columns+1560 Change:    PEN -1570  CALL Cursor(R0,C0)580  PEN 1590  CALL Cursor(R,C)600   ON Mode GOTO Pass,Set,Erase610   DEF FNAlive(A)=(A>=10) OR (A<0) AND (A>=-10)620 Erase:  PEN -1630 Set:  IF (Mode=Star)=FNAlive(A(R,C)) THEN 650640  CALL Toggle(R,C,A(*))650 Pass:   C0=C660  R0=R670  RETURN 680 Star:  IF Mode=Star THEN RETURN 690  Mode=Star700  IF FNAlive(A(R,C)) THEN RETURN
710  PEN 1720  CALL Toggle(R,C,A(*))730  RETURN 740 Scratch:  IF Mode=Scratch THEN RETURN 750  Mode=Scratch760  IF NOT FNAlive(A(R,C)) THEN RETURN 770  PEN -1780  CALL Toggle(R,C,A(*))790  RETURN 800 Cursor: Mode=Cursor810  RETURN 820 Start:  GOSUB Clear_keys830  Flag=0840  CALL Wrap(A(*))850  ON KEY #6 GOTO Begin860  ON KEY #22 GOSUB Flag870  PEN -1880  CALL Cursor(R,C)890  Label_x=0900  Label_y=MAX(Rows,Columns*455/560)910  LORG 1920  GOSUB New_label930 Gen_loop:  FOR R=1 TO Rows940  FOR C=1 TO Columns950  IF A(R,C)<0 THEN CALL Toggle(R,C,A(*))960  NEXT C970  NEXT R980  CALL Wrap(A(*))990  P=01000 FOR R=1 TO Rows1010 FOR C=1 TO Columns1020 IF A(R,C)<3 THEN 11001030 N=A(R,C)1040 IF N<10 THEN 10701050 IF (N=12) OR (N=13) THEN 11001060 GOTO 10801070 IF N<>3 THEN 11001080 A(R,C)=N-201090 P=11100 NEXT C1110 NEXT R1120 IF NOT P THEN Done1130 G=G+11140 GOSUB Label1150 IF NOT Flag THEN Gen_loop1160 FOR R=1 TO Rows1170 FOR C=1 TO Columns1180 IF A(R,C)<0 THEN A(R,C)=A(R,C)+201190 NEXT C1200 NEXT R1210 GOTO Repeat1220 Done:MOVE Label_x,Label_y
1230 PEN 11240 LABEL "GENERATION",G,"STABLE"1250 IF NOT Flag THEN 12501260 MOVE Label_x,Label_y1270 PEN -11280 LABEL "","","STABLE"1290 GOTO Repeat1300 Flag: Flag=11310 RETURN 1320 New_label: MOVE Label_x,Label_y
1330 PEN 11340 LABEL "GENERATION"1350 GOTO New_number1360 Label: MOVE Label_x,Label_y1370 PEN -11380 LABEL "",G-11390 New_number: PEN 11400 MOVE Label_x,Label_y1410 LABEL "",G1420 RETURN 1430 Clear_keys: FOR I=0 TO 311440 ON KEY #I GOSUB Beep1450 NEXT I1460 RETURN 1470 Beep:BEEP1480 RETURN 1490 SUB Cursor(C,R)1500 MOVE R-1,C-11510 DRAW R-1,C1520 DRAW R,C1530 DRAW R,C-11540 DRAW R-1,C-11550 SUBEND1560 SUB Star(C,R)1570 MOVE R-.3,C-.51580 DRAW R-.5,C-.31590 DRAW R-.7,C-.51600 DRAW R-.5,C-.71610 DRAW R-.3,C-.51620 SUBEND1630 SUB Toggle(R,C,A(*))1640 IF A(R,C)<0 THEN A(R,C)=A(R,C)+201650 D=1-2*(A(R,C)>=10)1660 A(R-1,C-1)=A(R-1,C-1)+D1670 A(R-1,C)=A(R-1,C)+D1680 A(R-1,C+1)=A(R-1,C+1)+D1690 A(R,C-1)=A(R,C-1)+D1700 A(R,C)=A(R,C)+10*D1710 A(R,C+1)=A(R,C+1)+D1720 A(R+1,C-1)=A(R+1,C-1)+D1730 A(R+1,C)=A(R+1,C)+D1740 A(R+1,C+1)=A(R+1,C+1)+D
1750 PEN D1760 CALL Star(R,C)1770 SUBEND1780 SUB Wrap(A(*))1790 Rows=ROW(A(*))-21800 Columns=COL(A(*))-21810 FOR R=0 TO Rows+11820 A(R,1)=A(R,1)+A(R,Columns+1)1830 A(R,Columns)=A(R,Columns)+A(R,0)1840 A(R,0)=A(R,Columns+1)=01850 NEXT R1860 FOR C=1 TO Columns1870 A(1,C)=A(1,C)+A(Rows+1,C)1880 A(Rows,C)=A(Rows,C)+A(0,C)1890 A(0,C)=A(Rows+1,C)=01900 NEXT C1910 SUBEND