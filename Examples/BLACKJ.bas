10   PRINTER IS 1620   OPTION BASE 130   ON KEY #0 GOSUB Confirm40   ON ERROR CALL Errorroutine50   COM Deck(52),Next,Handstart,Confirmation,Ratio,Others,Tens60   COM Names$(6)[4],Valuearray(13),Printvalue$(13)[1]70   COM Aces(5),Bust(5),Cardcount(5),Hand(12,5),Handtotal(5)80   DIM Bet(4),Boss$[6],Dealer$[6],Disagree$[13],Name$(23)[6],Play$[80],Recommend$[2],Sorry$[65]81   ON KEY #0 GOTO Otherstick82   ON KEY #2 GOTO Splitroutine83   ON KEY #4 GOTO Natural84   ON KEY #8 GOTO Hitroutine85   ON KEY #10 GOTO Doubledown86   ON KEY #7 GOTO Out87   GOTO 10088 Out:   GET "MENU",10,10100  MAT READ Printvalue$,Valuearray,Name$110  DATA "A","2","3","4","5","6","7","8","9","T","J","Q","K"120  DATA 1,2,3,4,5,6,7,8,9,10,10,10,10130  DATA "Jan","Jessie","Barbie","Susan","Alice","Diane","Cyndi","Kathy"140  DATA "Ann","Amy","Eliza","Carrie","Wendy","Larry","Russ","Rocky","Howard"150  DATA "Dennis","Chris","Burt","Paul","Jim","John"160  RANDOMIZE 170    FOR I=0 TO 51180    Deck(I+1)=I MOD 13+1190    NEXT I200  MAT READ Names$210  Disagree$=CHR$(7)&"I disagree--"220  DATA "en","ack","ueen","ing","ce"," "230  Sorry$="I'm sorry, but I'm not allowed to give you that much insurance,"240  Dealer$=Name$(INT(RND*13+1))250  Boss$=Name$(INT(RND*10+14))260  PRINT PAGE;"Hi!  I'm ";Dealer$;"...I'll be your dealer this time around."270  PRINT "Would you care for the pit boss to explain our rules?"271  PRINT "(KEY 14=YES, KEY 15=NO)"280  ON KEY #14 GOTO 300281  ON KEY #15 GOTO Gameplay282  GOTO 282300  PRINT LIN(1);"OK, kid, I'm ";Boss$;" and here are our casino's rules:"310  PRINTER IS 16 !0320    FOR J=1 TO 50330    READ Play$340    PRINT Play$350    NEXT J351    PRINT LIN(1);"Use the special function keys to play your hand."352    PRINT TAB(20);"KEY  8 IS HIT"353    PRINT TAB(20);"KEY  0 IS STAND"354    PRINT TAB(20);"KEY 10 IS DOUBLE DOWN"355    PRINT TAB(20);"KEY  2 IS SPLIT"356    PRINT TAB(20);"KEY  4 IS 21 (BLACKJACK)"357    PRINT TAB(20);"KEY 14 IS YES"358    PRINT TAB(20);"KEY 15 IS NO"360  PRINTER IS 16370  PRINT "This is ";Boss$;" again.  All set now to play?  Good luck!"380  DATA "     The object of the game is to get more points than the dealer"390  DATA "without going over 21 ('busting').  If you succeed, or if the dealer"400  DATA "busts and you don't, you win at even money.  If you tie the dealer (have"410  DATA "the same score without busting), then you 'push' and no money changes"420  DATA "hands.  Otherwise, you lose.  It's that simple.
430  DATA "     At the beginning of each hand, each player and the dealer are"440  DATA "alternately dealt two cards.  The dealer's second card is dealt face up"450  DATA "giving the players a clue to the dealer's hand.  The dealer's first"460  DATA "dealt card is here 'hole' card.470  DATA "     Aces count as either 1 point or 11 points, at your discretion, and"480  DATA "face cards are worth 10 points each.  All other cards count at face"490  DATA "value."500  DATA "     An ace dealt with a 10-point card as the first two cards dealt to"510  DATA "your hand is called a 'natural'.  If the dealer has an ace showing in"520  DATA "her hand, you will be offered insurance against a dealer natural."530  DATA "Insurance is a side bet, no more than half the size of the main bet,"540  DATA "that pays 2-to-1 if the dealer does have a 10-point card in the hole."550  DATA "If the dealer has a natural, you won't get to play out that hand"560  DATA "(insurance is not a play).  If you have a natural, and declare it as"570  DATA "your first play, you automatically win and get paid 1.5-to-1.  If you"580  DATA "and the dealer both have naturals, then you push.  To declare a natural"590  DATA "your play should be 'blackjack', '21', or 'natural'."600  DATA "     If you are dealt a pair, say two Jacks, in your first two cards,"610  DATA "you may 'split' them.  In that case, each card has another card dealt"620  DATA "to it, and each is played in turn as a separate hand.  Each hand then"630  DATA "has a bet placed on it equal in size to the original main bet, and each"640  DATA "hand subsequently may be split again if a pair is dealt to it.  Once"650  DATA "split, a hand may not be declared a natural.  If you want to split a"660  DATA "pair, the play to use is 'split'."670  DATA "     You have three other play options:  hit, stand, or double down."680  DATA "If you 'hit', then you take, one at a time, as many cards as you wish"690  DATA "until you either bust or decide to stand.  When you 'stand', you receive"700  DATA "no more cards to that hand, and the play passes to the next hand (if you"710  DATA "have split), or to the dealer.  'Stick', 'pass', and 'stay' are"720  DATA "all the same as 'stand'.  If you 'double down', you are doubling the"730  DATA "size of the bet on that hand and electing have the dealer give you, one"740  DATA "and only one, card for that hand.  Play then turns to the next hand (if"750  DATA "you have split) or to the dealer.  You may not double down a hand that"760  DATA "has been hit."770  DATA "     Unless you had a natural, or busted every hand, the dealer will"780  DATA "eventually play out her hand.  She must hit a total that is under 17 and"790  DATA "must stand on any total that is over 16 (counting an ace as 11 if"800  DATA "necessary)."810  DATA "     If you want a new deck, you may ask for it by making a bet less"820  DATA "than 0."830  DATA "     There is a table limit, by the way, of $5000."840  DATA "Remember:"850  DATA "     Answer only the question being asked;"860  DATA "     The funds and bets are in dollars; and"870  DATA "     Liars are bounced!!"880 Gameplay:   INPUT "How much money are you gambling with this time?",Input890  Funds=PROUND(Input,-2)900  Original=Funds910  IF Funds>.01 THEN GOTO Newhand920  PRINT "Now, sweetheart, you gotta have money to play with me."930  GOTO Gameplay940 Newhand: CALL Shuffle(1)950 Betting: INPUT "How much would you like to bet now?",Input960  Bet(1)=PROUND(Input,-2)970  IF Bet(1)<>0 THEN GOTO Continue980  Bet(1)=(Funds-Original)*100/Original/Handsplayed990  IF Bet(1)>-2 THEN GOTO Out11000 PRINT "Anyone who loses money at the rate you do can play here anytime."1010 PRINT "Goodbye...Do come again!"1020 STOP1030 Out1:  IF Bet(1)>=0 THEN GOTO Out21040 PRINT "When you have more money you would like to lose, please come again."1050 STOP1060 Out2:  IF Bet(1)>0 THEN GOTO Out31070 PRINT "Maybe one of us will do better next time.  Goodbye...come again."1080 STOP1090 Out3:  IF Bet(1)>2 THEN GOTO Out41100 PRINT "I've enjoyed dealing with you this time.  Goodbye...come again."1110 STOP1120 Out4:  PRINT "We would prefer that anyone who wins like you do take their business"1130 PRINT "to one of the other casinos on the strip.  Goodbye."1140 STOP1150 Continue:IF Bet(1)>0 THEN GOTO Playgame1160 PRINT TAB(40);"Sure, I'm happy to get you a new deck!"1170 GOTO Newhand1180 Playgame:IF Bet(1)<=Funds THEN GOTO Playon1190 DISP "Are you asking for more credit?"1192 ON KEY #14 GOTO 12101193 ON KEY #15 GOTO Betting1200 GOTO 12001210 PRINT "I'll call the pit boss."1220 Play$="This is "&Boss$&"...How much additional credit do you need"1230 DISP Play$;1240 INPUT Input1250 Credit=PROUND(Input,-2)1260 IF (ABS(Credit)<=.01) OR (Credit<-Funds) OR (Credit>2*Funds+100) THEN GOTO Badcredit1270 Funds=Funds+Credit1280 Original=Original+Credit1290 PRINT "OK, you've got it."1300 GOTO Betting1310 Badcredit: PRINT "I can't give you that kind of credit."1320 GOTO Betting1330 Playon: IF Bet(1)>=.01 THEN GOTO Realplay1340 PRINT "No foreign money accepted at this table."1350 GOTO Betting1360 Realplay:  IF Bet(1)<=5000 THEN GOTO Goodplay1370 PRINT "I'm sorry, the table limit is $5000."1380 GOTO Betting1390 Goodplay:  Funds=Funds-Bet(1)1400 Handflag=11410 Splitflag=11420 Handstart=Next1430 IF Handstart<=52 THEN GOTO Nonshuffle1440 CALL Shuffle(1)1450 Handstart=Next1460 Nonshuffle:  Handsplayed=Handsplayed+11470 PRINT PAGE;TAB(10);"RESERVE= $";Funds;SPA(5);"BET= $";Bet(1);LIN(1)1480 PRINT TAB(5);CHR$(132);"You";CHR$(128);TAB(45);CHR$(132);Dealer$;CHR$(128);LIN(1)1490 MAT Aces=ZER1500 MAT Handtotal=ZER1510 MAT Cardcount=ZER1520 MAT Bust=ZER1530 CALL Card(1)1540 CALL Card(5)1550 Line$=FNPrinter$(Hand(1,1))1560 Play$=FNPrinter$(Hand(1,5))1570 PRINT "You drew";Line$;TAB(40);"I'm showing";Play$1580 CALL Card(1)1590 CALL Card(5)1600 IF Hand(2,5)>=10 THEN Tens=Tens+11610 IF Hand(2,5)<10 THEN Others=Others+11620 Ratio=991630 IF Tens<>0 THEN Ratio=Others/Tens1640 Line$=FNPrinter$(Hand(2,1))1650 PRINT "You drew";Line$;LIN(1)1660 IF Hand(1,5)=1 THEN GOTO Notace1670 Checkblkjk: IF Handtotal(5)+10*Aces(5)<>21 THEN GOTO Playhand1680 Allover:  Line$=FNPrinter$(Hand(2,5))1690 PRINT TAB(40);"I have";Line$;"under--a blackjack!"1700 IF Handtotal(1)+10*Aces(1)<>21 THEN GOTO Playerlose1710 PRINT "Hmmm.  We both seem to have 21.  We push."1720 Funds=Funds+Bet(1)1730 GOTO Accounting1740 Playerlose: PRINT TAB(40);CHR$(130);"It beats what you have.";CHR$(128)1750 GOTO Accounting1760 Notace: DISP "Would you like to insure against my ace?"1761 PRINT "(KEY 14=YES, KEY 15=NO)"1770 Again: ON KEY #14 GOTO Please1771 ON KEY #15 GOTO 17901772 GOTO 17721790 IF Confirmation AND (Ratio>2) THEN DISP "I agree--";1800 IF Confirmation AND (Ratio<=2) THEN DISP Disagree$;1810 GOTO Checkblkjk1820 Please:  IF Confirmation AND (Ratio<=2) THEN DISP "I agree--";1830 IF Confirmation AND (Ratio>2) THEN DISP Disagree$;1840 INPUT "How much insurance will you take?",I1850 IF I<=Bet(1)/2 THEN GOTO Takeinsurance1860 PRINT Sorry$1870 PRINT "your request is greater than one-half your bet."1880 GOTO Tryagain1890 Takeinsurance: IF I<=Funds THEN GOTO Insurance1900 PRINT Sorry$1910 PRINT "you don't have the chips on the table to cover it all."1920 IF Funds<=.01 THEN GOTO Checkblkjk1930 GOTO Tryagain1940 Nogood: PRINT "No foreign money allowed at this table."1950 Tryagain:  DISP "Do you want to try insuring again?"1960 GOTO Again1970 Insurance: IF I<=.01 THEN GOTO Nogood1980 IF Valuearray(Hand(2,5))<>10 THEN GOTO Noblkjk1990 Funds=Funds+I*22000 PRINT TAB(40);"How about that.  Your insurance paid off."2010 GOTO Allover2020 Noblkjk: PRINT TAB(40);"I'll be taking that insurance bet."2030 Funds=Funds-I2040 GOTO Playhand2050 Huh: PRINT TAB(40);"You mumbled, I couldn't hear you."2060 Playhand:  Hand$=""2070 IF Splitflag=1 THEN GOTO Nextplay2080 ON Handflag GOTO One,Two,Three,Four2090 One: Hand$=" first"2100 GOTO Nextplay2110 Two:  Hand$=" second"2120 GOTO Nextplay2130 Three:  Hand$=" third"2140 GOTO Nextplay2150 Four:  Hand$=" fourth"2160 Nextplay:  DISP "How do you wish to play your"&Hand$&" hand"2170 IF Confirmation THEN GOSUB Thorpe2180 ! DISP Play$2181 GOTO 21812190 Play$=Play$[1;2]2200 Play$=UPC$(TRIM$(Play$))2210 IF (Play$[1;1]="H") OR (Play$="DR") THEN GOTO Hitroutine2220 IF Play$="DO" THEN GOTO Doubledown2230 IF (Play$="NA") OR (Play$="21") OR (Play$="BL") THEN GOTO Natural2240 IF Play$="SP" THEN GOTO Splitroutine2250 IF (Play$<>"ST") AND (Play$<>"PA") THEN GOTO Huh2260 Otherstick:  IF Confirmation AND (Recommend$="ST") THEN DISP "I agree--";2270 IF Confirmation AND (Recommend$<>"ST") THEN DISP Disagree$;2280 Stickroutine: Handflag=Handflag+12290 IF Handflag<=Splitflag THEN GOTO Playhand2300 Splithands: IF Handtotal(5)+10*Aces(5)>=17 THEN GOTO Specialsit2310   FOR I=1 TO Splitflag2320   IF Bust(I)=0 THEN GOTO Goodhand2330   NEXT I2340 Specialsit: Handtotal(5)=Handtotal(5)+10*Aces(5)2350 GOTO Handcontinues2360 Goodhand: CALL Card(5)2370 Line$=FNPrinter$(Hand(Cardcount(5),5))2380 PRINT TAB(40);"I drew";Line$2390 IF Bust(5) THEN GOTO Dealerbust2400 IF Handtotal(5)+10*Aces(5)<17 THEN GOTO Goodhand2410 GOTO Specialsit2420 Dealerbust: PRINT TAB(40);"Sigh.  I bust."2430 Handcontinues:  Line$=TRIM$(FNPrinter$(Hand(2,5)))2440 PRINT TAB(40);"Since my hole card is ";Line$;","2450 PRINT TAB(40);"my hand's value is";Handtotal(5)2460    FOR I=1 TO Splitflag2470    Handtotal(I)=Handtotal(I)+10*Aces(I)2480    PRINT TAB(I*10-10);"I see that you have";Handtotal(I)2490    IF Bust(I) THEN GOTO Dealerwins2500    IF Bust(5) OR (Handtotal(I)>Handtotal(5)) THEN GOTO Playerwins2510    IF Handtotal(I)=Handtotal(5) THEN GOTO Pushtime2520 Dealerwins:  PRINT TAB(40);CHR$(130);"So I win.";CHR$(128)2530    GOTO Loopend2540 Pushtime:  PRINT TAB(I*10+10);CHR$(130);"So we push.";CHR$(128)2550    Funds=Funds+Bet(I)2560    GOTO Loopend2570 Playerwins:  Funds=Funds+2*Bet(I)2580    PRINT TAB(I*10-10);CHR$(130);"So you win.";CHR$(128)2590 Loopend:  NEXT I2600 Accounting:  PRINT CHR$(129);LIN(1);"You now have $";Funds;CHR$(128)2610 IF Hand(2,5)>=10 THEN Tens=Tens-12620 IF Hand(2,5)<10 THEN Others=Others-12630 GOTO Betting2640 Hitroutine:  CALL Card(Handflag)2650 IF Confirmation AND (Recommend$="H") THEN DISP "I agree--";2660 IF Confirmation AND (Recommend$<>"H") THEN DISP Disagree$;2670 Line$=FNPrinter$(Hand(Cardcount(Handflag),Handflag))2680 PRINT TAB(Handflag*10-10);"You drew";Line$2690 Busted: IF Bust(Handflag) THEN GOTO Youlose2700 Inquiry: DISP "Hit or stay?"2701 GOTO 27012710 IF Confirmation THEN GOSUB Thorpe2720 Play$=UPC$(TRIM$(Play$))2730 Play$=Play$[1;4]2740 IF (Play$[1;1]="H") OR (Play$[1;1]="Y") OR (Play$="SURE") THEN GOTO Hitroutine2750 Play$=Play$[1;2]2760 IF (Play$="ST") OR (Play$="NO") OR (Play$="PA") THEN GOTO Otherstick2770 PRINT TAB(40);"You mumbled; I couldn't hear you."2780 GOTO Inquiry2790 Youlose: PRINT TAB(Handflag*10-10);"Sorry, but you bust."2800 GOTO Stickroutine2810 Natural: IF Splitflag<=1 THEN GOTO Badboy2820 PRINT "Now, you can't have a natural on a split hand."2830 GOTO Playhand2840 Badboy: IF (Handtotal(1)=11) AND (Cardcount(1)=2) AND (Aces(1)=1) THEN GOTO Goodboy2850 Liar: PRINT CHR$(129);"LIAR!!";CHR$(128)2860 STOP2870 Goodboy: Funds=Funds+PROUND(2.5*Bet(1),-2)2880 IF Confirmation THEN DISP "I agree--";2890 Line$=FNPrinter$(Hand(1,5))2900 PRINT TAB(40);"My hole card is";Line$2910 GOTO Accounting2920 Doubledown:  IF Bet(Handflag)<=Funds THEN GOTO Doubleroutine2930 PRINT "Sorry, but you don't have enough on the table to double down."2940 GOTO Busted2950 Doubleroutine: Funds=Funds-Bet(Handflag)2960 Bet(Handflag)=Bet(Handflag)*22970 IF Confirmation AND (Recommend$="DO") THEN DISP "I agree--";2980 IF Confirmation AND (Recommend$<>"DO") THEN DISP Disagree$;2990 CALL Card(Handflag)3000 Line$=FNPrinter$(Hand(Cardcount(Handflag),Handflag))3010 PRINT TAB(Handflag*10-10);"You drew";Line$3020 IF Bust(Handflag) THEN PRINT "So sorry, but you bust with";Handtotal(Handflag)3030 GOTO Stickroutine3040 Splitroutine: IF (Hand(1,Handflag)<>Hand(2,Handflag)) OR (Cardcount(Handflag)>2) THEN GOTO Liar3050 IF Funds>=Bet(Handflag) THEN GOTO Splitem3060 PRINT "You don't have enough on the table for me to let you split."3070 GOTO Busted3080 Splitem: Funds=Funds-Bet(Handflag)3090 IF Confirmation AND (Recommend$="SP") THEN DISP "I agree--";3100 IF Confirmation AND (Recommend$<>"SP") THEN DISP Disagree$;3110 Splitflag=Splitflag+13120 Bet(Splitflag)=Bet(Handflag)3130 Hand(1,Splitflag)=Hand(2,Handflag)3140 Handtotal(Handflag)=Handtotal(Handflag)/23150 Handtotal(Splitflag)=Handtotal(Handflag)3160 Aces(Splitflag)=Aces(Handflag)3170 Cardcount(Handflag)=13180 Cardcount(Splitflag)=13190 CALL Card(Handflag)3200 Line$=FNPrinter$(Hand(2,Handflag))3210 PRINT TAB(Handflag*10-10);"The first hand draws";Line$3220 CALL Card(Splitflag)3230 Line$=FNPrinter$(Hand(2,Splitflag))3240 PRINT TAB(Handflag*10);"and the second hand draws";Line$3250 GOTO Playhand3260 Confirm:  Confirmation=1-Confirmation3270 RETURN 3280 Thorpe:  IF (Cardcount(Handflag)<>2) OR (Hand(1,Handflag)<>Hand(2,Handflag)) THEN GOTO Nopair3290 ON Hand(1,Handflag) GOTO Pair,Deuces,Deuces,Fours,Nopair,Deuces,Sevens,Pair,Nines,Nopair,Nopair,Nopair,Nopair3300 Deuces:  IF (Hand(1,5)<8) AND (Hand(1,5)<>1) THEN GOTO Pair3310 GOTO Nopair3320 Fours:  IF Hand(1,5)=5 THEN GOTO Pair3330 GOTO Nopair3340 Sevens:  IF (Hand(1,5)<9) AND (Hand(1,5)<>1) THEN GOTO Pair3350 GOTO Nopair3360 Nines:  IF (Hand(1,5)=1) OR (Hand(1,5)=7) OR (Hand(1,5)>=10) THEN GOTO Nopair3370 Pair:  Recommend$="SP"3380 RETURN 3390 Nopair:  IF Aces(Handflag) THEN GOTO Soft3400 ON Handtotal(Handflag) GOTO Hit,Hit,Hit,Hit,Hit,Hit,Hit,Hit,Have9,Have10,Have11,Have12,Hav13,Hav13,Hav13,Hav16,Standing,Standing,Standing,Standing,Standing3410 Have9:  IF (Cardcount(Handflag)=2) AND (Hand(1,5)<7) AND (Hand(1,5)<>1) THEN GOTO Doubling3420 GOTO Hit3430 Have10:  IF (Cardcount(Handflag)=2) AND (Hand(1,5)<>1) AND ((Hand(1,5)<10) OR (Ratio<=2)) THEN GOTO Doubling3440 GOTO Hit3450 Have11:  IF Cardcount(Handflag)=2 THEN GOTO Doubling3460 GOTO Hit3470 Have12:  ON Hand(1,5) GOTO Hit,Test12,Test12,Standing,Standing,Standing,Hit,Hit,Hit,Hit,Hit,Hit,Hit3480 Test12:  IF Ratio<=2 THEN GOTO Standing3490 GOTO Hit3500 GOTO Standing3510 Hav13:  IF (Hand(1,5)>6) OR (Hand(1,5)=1) THEN GOTO Hit3520 GOTO Standing3530 Hav16:  IF (Hand(1,5)>6) OR (Hand(1,5)=1) OR (Hand(1,5)>=10) AND (Ratio>2) THEN GOTO Hit3540 Standing:  Recommend$="ST"3550 RETURN 3560 Hit:  Recommend$="H"3570 RETURN 3580 Doubling:  Recommend$="DO"3590 RETURN 3600 Soft:  IF (Cardcount(Handflag)<>2) OR (Hand(1,5)>6) OR (Hand(1,5)<3) THEN GOTO Nodouble3610 ON Handtotal(Handflag) GOTO Hit,Pair,Have2,Have3,Have3,Have3,Doubling,Doubling,Have8,Standing,Standing3620 Have2:  IF Ratio<=2 THEN GOTO Have33630 IF Hand(1,5)>4 THEN GOTO Doubling3640 GOTO Hit3650 Have3:  IF Hand(1,5)>3 THEN GOTO Doubling3660 GOTO Hit3670 Have8:  IF (Hand(1,5)>4) AND (Ratio<=2) THEN GOTO Doubling3680 GOTO Standing3690 Nodouble:  IF (Handtotal(Handflag)<8) OR (Hand(1,5)>8) AND (Handtotal(Handflag)=8) THEN GOTO Hit3700 GOTO Standing3710 END3720 DEF FNPrinter$(I)3730 OPTION BASE 13740 COM Deck(52),Next,Handstart,Confirmation,Ratio,Others,Tens3750 COM Names$(6)[4],Valuearray(13),Printvalue$(13)[1]3760 COM Aces(5),Bust(5),Cardcount(5),Hand(12,5),Handtotal(5)3770 DIM K$[2]3780 K$="a"3790 IF (I=1) OR (I=8) THEN K$="an"3800 FOR J=10 TO 133810 IF I=J THEN GOTO Found3820 NEXT J3830 J=143840 IF I<>1 THEN J=153850 Found: RETURN " "&K$&" "&Printvalue$(I)&Names$(J-9)&" "
3860 FNEND3870 SUB Card(I)3880 OPTION BASE 13890 COM Deck(52),Next,Handstart,Confirmation,Ratio,Others,Tens3900 COM Names$(6)[4],Value(13),Printvalue$(13)[1]3910 COM Aces(5),Bust(5),Count(5),Hand(12,5),Total(5)3920 IF Next>52 THEN CALL Shuffle(0)3930 Count(I)=Count(I)+13940 Z=Count(I)3950 Hand(Z,I)=Deck(Next)3960 Total(I)=Total(I)+Value(Hand(Z,I))3970 Next=Next+13980 IF Hand(Z,I)=1 THEN Aces(I)=13990 IF Total(I)>21 THEN Bust(I)=14000 IF Total(I)>11 THEN Aces(I)=04010 IF Hand(Z,I)<10 THEN Others=Others-14020 IF Hand(Z,I)>=10 THEN Tens=Tens-14030 Ratio=994040 IF Tens<>0 THEN Ratio=Others/Tens4050 SUBEND4060 SUB Shuffle(Flag)4070 OPTION BASE 14080 !ON ERROR CALL Errorroutine4090 COM Deck(52),Next,Handstart,Confirmation,Ratio,Others,Tens4100 DIM Line$[10]4110 Next=14120 Cards=524130 Others=364140 Tens=164150 IF Cardcount(1)=0 THEN Flag=14160 IF Flag THEN GOTO Shuffling4170   FOR J=Handstart TO 524180   I=Deck(Next)4190   Deck(Next)=Deck(J)4200   Deck(J)=I4210   Next=Next+14220   Cards=Cards-14230   NEXT J4240 IF Hand(2,5)>=10 THEN Tens=Tens+14250 IF Hand(2,5)<10 THEN Others=Others+14260 Shuffling:  PRINT TAB(40);"Pardon me while I reshuffle."4270   FOR I=Next TO 524280   N=INT(RND*Cards)+Next4290   J=Deck(N)4300   Deck(N)=Deck(I)4310   Deck(I)=J4320   NEXT I4330 Kards=Cards-54340   FOR N=1 TO 34350   I=Deck(Next)4360   Line$=FNPrinter$(I)4370   IF (I>1) AND (I<10) THEN GOTO Shuffled4380   K=INT(RND*Kards)+4+Next4390     FOR J=Next TO K4400     Deck(J)=Deck(J+1)4410     NEXT J4420   Deck(K+1)=I4430   PRINT TAB(40);"I've buried";Line$4440   NEXT N4450 GOTO Shuffling4460 Shuffled:  PRINT TAB(40);"I've burned";Line$4470 Next=Next+14480   FOR I=1 TO Next-14490   IF Deck(I)>=10 THEN Tens=Tens-14500   IF Deck(I)<10 THEN Others=Others-14510   NEXT I4520 Ratio=994530 IF Tens<>0 THEN Ratio=Others/Tens4540 SUBEND4550 SUB Errorroutine4560 IF (ERRN=10) OR (ERRN=11) OR (ERRN=32) THEN GOTO Mumble4570 PRINT "I hear alarm bell";ERRN;"--the casino's on fire--we'll have to leave!!"4580 PRINT "Go directly to line";ERRL4590 STOP4600 Mumble:  INPUT "You mumbled again.  What did you say?",Input4610 SUBEND